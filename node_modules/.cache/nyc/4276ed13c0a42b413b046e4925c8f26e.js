'use strict';var cov_1v7dyldmrm=function(){var path="C:\\Users\\HP\\Desktop\\theBootcamp\\v1\\controllers\\questionsControllers.js",hash="f9f24f65bd7595051bb86c26e51d14f20136e015",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"C:\\Users\\HP\\Desktop\\theBootcamp\\v1\\controllers\\questionsControllers.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:7,column:23},end:{line:7,column:59}},"2":{start:{line:9,column:24},end:{line:9,column:64}},"3":{start:{line:11,column:21},end:{line:11,column:55}},"4":{start:{line:13,column:22},end:{line:13,column:60}},"5":{start:{line:15,column:19},end:{line:15,column:51}},"6":{start:{line:17,column:20},end:{line:17,column:56}},"7":{start:{line:19,column:39},end:{line:19,column:93}},"8":{start:{line:21,column:16},end:{line:125,column:1}},"9":{start:{line:23,column:19},end:{line:23,column:27}},"10":{start:{line:24,column:8},end:{line:28,column:9}},"11":{start:{line:25,column:12},end:{line:27,column:15}},"12":{start:{line:29,column:30},end:{line:29,column:77}},"13":{start:{line:30,column:8},end:{line:50,column:11}},"14":{start:{line:53,column:19},end:{line:53,column:38}},"15":{start:{line:54,column:27},end:{line:54,column:77}},"16":{start:{line:55,column:20},end:{line:55,column:39}},"17":{start:{line:56,column:8},end:{line:69,column:9}},"18":{start:{line:57,column:12},end:{line:68,column:15}},"19":{start:{line:59,column:20},end:{line:66,column:22}},"20":{start:{line:70,column:8},end:{line:72,column:11}},"21":{start:{line:76,column:19},end:{line:76,column:40}},"22":{start:{line:77,column:22},end:{line:77,column:60}},"23":{start:{line:78,column:8},end:{line:83,column:9}},"24":{start:{line:79,column:12},end:{line:79,column:51}},"25":{start:{line:80,column:12},end:{line:82,column:15}},"26":{start:{line:84,column:8},end:{line:86,column:11}},"27":{start:{line:89,column:19},end:{line:89,column:40}},"28":{start:{line:90,column:26},end:{line:90,column:75}},"29":{start:{line:92,column:22},end:{line:92,column:65}},"30":{start:{line:94,column:24},end:{line:94,column:69}},"31":{start:{line:95,column:8},end:{line:101,column:9}},"32":{start:{line:96,column:33},end:{line:96,column:82}},"33":{start:{line:97,column:12},end:{line:100,column:15}},"34":{start:{line:102,column:8},end:{line:104,column:11}},"35":{start:{line:107,column:19},end:{line:107,column:40}},"36":{start:{line:109,column:26},end:{line:109,column:75}},"37":{start:{line:111,column:22},end:{line:111,column:65}},"38":{start:{line:113,column:24},end:{line:113,column:69}},"39":{start:{line:114,column:8},end:{line:120,column:9}},"40":{start:{line:115,column:33},end:{line:115,column:84}},"41":{start:{line:116,column:12},end:{line:119,column:15}},"42":{start:{line:121,column:8},end:{line:123,column:11}},"43":{start:{line:127,column:0},end:{line:127,column:28}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:19,column:9},end:{line:19,column:31}},loc:{start:{line:19,column:37},end:{line:19,column:95}},line:19},"1":{name:"createQuestion",decl:{start:{line:22,column:29},end:{line:22,column:43}},loc:{start:{line:22,column:54},end:{line:51,column:5}},line:22},"2":{name:"getAllQuestions",decl:{start:{line:52,column:30},end:{line:52,column:45}},loc:{start:{line:52,column:56},end:{line:73,column:5}},line:52},"3":{name:"(anonymous_3)",decl:{start:{line:58,column:39},end:{line:58,column:40}},loc:{start:{line:58,column:59},end:{line:67,column:17}},line:58},"4":{name:"_delete",decl:{start:{line:74,column:21},end:{line:74,column:28}},loc:{start:{line:74,column:39},end:{line:87,column:5}},line:74},"5":{name:"upvote",decl:{start:{line:88,column:21},end:{line:88,column:27}},loc:{start:{line:88,column:38},end:{line:105,column:5}},line:88},"6":{name:"downvote",decl:{start:{line:106,column:23},end:{line:106,column:31}},loc:{start:{line:106,column:42},end:{line:124,column:5}},line:106}},branchMap:{"0":{loc:{start:{line:19,column:46},end:{line:19,column:92}},type:"cond-expr",locations:[{start:{line:19,column:70},end:{line:19,column:73}},{start:{line:19,column:76},end:{line:19,column:92}}],line:19},"1":{loc:{start:{line:19,column:46},end:{line:19,column:67}},type:"binary-expr",locations:[{start:{line:19,column:46},end:{line:19,column:49}},{start:{line:19,column:53},end:{line:19,column:67}}],line:19},"2":{loc:{start:{line:24,column:8},end:{line:28,column:9}},type:"if",locations:[{start:{line:24,column:8},end:{line:28,column:9}},{start:{line:24,column:8},end:{line:28,column:9}}],line:24},"3":{loc:{start:{line:24,column:12},end:{line:24,column:125}},type:"binary-expr",locations:[{start:{line:24,column:12},end:{line:24,column:23}},{start:{line:24,column:27},end:{line:24,column:37}},{start:{line:24,column:41},end:{line:24,column:55}},{start:{line:24,column:59},end:{line:24,column:69}},{start:{line:24,column:73},end:{line:24,column:89}},{start:{line:24,column:93},end:{line:24,column:106}},{start:{line:24,column:110},end:{line:24,column:125}}],line:24},"4":{loc:{start:{line:56,column:8},end:{line:69,column:9}},type:"if",locations:[{start:{line:56,column:8},end:{line:69,column:9}},{start:{line:56,column:8},end:{line:69,column:9}}],line:56},"5":{loc:{start:{line:78,column:8},end:{line:83,column:9}},type:"if",locations:[{start:{line:78,column:8},end:{line:83,column:9}},{start:{line:78,column:8},end:{line:83,column:9}}],line:78},"6":{loc:{start:{line:95,column:8},end:{line:101,column:9}},type:"if",locations:[{start:{line:95,column:8},end:{line:101,column:9}},{start:{line:95,column:8},end:{line:101,column:9}}],line:95},"7":{loc:{start:{line:95,column:12},end:{line:95,column:47}},type:"binary-expr",locations:[{start:{line:95,column:12},end:{line:95,column:23}},{start:{line:95,column:27},end:{line:95,column:34}},{start:{line:95,column:38},end:{line:95,column:47}}],line:95},"8":{loc:{start:{line:114,column:8},end:{line:120,column:9}},type:"if",locations:[{start:{line:114,column:8},end:{line:120,column:9}},{start:{line:114,column:8},end:{line:120,column:9}}],line:114},"9":{loc:{start:{line:114,column:12},end:{line:114,column:47}},type:"binary-expr",locations:[{start:{line:114,column:12},end:{line:114,column:23}},{start:{line:114,column:27},end:{line:114,column:34}},{start:{line:114,column:38},end:{line:114,column:47}}],line:114}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0,0,0,0,0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0,0],"8":[0,0],"9":[0,0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_1v7dyldmrm.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});var _questionsModels=(cov_1v7dyldmrm.s[1]++,require('../models/questionsModels'));var _questionsModels2=(cov_1v7dyldmrm.s[2]++,_interopRequireDefault(_questionsModels));var _meetupsModels=(cov_1v7dyldmrm.s[3]++,require('../models/meetupsModels'));var _meetupsModels2=(cov_1v7dyldmrm.s[4]++,_interopRequireDefault(_meetupsModels));var _usersModels=(cov_1v7dyldmrm.s[5]++,require('../models/usersModels'));var _usersModels2=(cov_1v7dyldmrm.s[6]++,_interopRequireDefault(_usersModels));function _interopRequireDefault(obj){cov_1v7dyldmrm.f[0]++;cov_1v7dyldmrm.s[7]++;return(cov_1v7dyldmrm.b[1][0]++,obj)&&(cov_1v7dyldmrm.b[1][1]++,obj.__esModule)?(cov_1v7dyldmrm.b[0][0]++,obj):(cov_1v7dyldmrm.b[0][1]++,{default:obj});}var Questions=(cov_1v7dyldmrm.s[8]++,{createQuestion:function createQuestion(req,res){cov_1v7dyldmrm.f[1]++;var data=(cov_1v7dyldmrm.s[9]++,req.body);cov_1v7dyldmrm.s[10]++;if((cov_1v7dyldmrm.b[3][0]++,!data.title)&&(cov_1v7dyldmrm.b[3][1]++,!data.body)&&(cov_1v7dyldmrm.b[3][2]++,!data.meetupId)&&(cov_1v7dyldmrm.b[3][3]++,!data.user)&&(cov_1v7dyldmrm.b[3][4]++,!data.questionId)&&(cov_1v7dyldmrm.b[3][5]++,!data.upvotes)&&(cov_1v7dyldmrm.b[3][6]++,!data.downvotes)){cov_1v7dyldmrm.b[2][0]++;cov_1v7dyldmrm.s[11]++;return res.status(400).json({message:'All fields are required'});}else{cov_1v7dyldmrm.b[2][1]++;}var createdQuestion=(cov_1v7dyldmrm.s[12]++,_questionsModels2.default.askQuestion(req.body));cov_1v7dyldmrm.s[13]++;return releaseEvents.status(201).json({createdBy:createdQuestion.createdBy,meetupId:createdQuestion.meetupId,questionId:createdQuestion.questionId,body:createdQuestion.body,title:createdQuestion.title,upvote:createdQuestion.upvote,downvote:createdQuestion.downvote,Post:{type:'GET',url:'http://localhost:3000/v1/meetups/'+createdQuestion.meetupId},upVote_Question:{type:'PATCH',url:'http://localhost:3000/v1/questions/'+createdQuestion.questionId+'/upvote'},downVote_Question:{type:'PATCH',url:'http://localhost:3000/v1/questions/'+createdQuestion.questionId+'/downvote'}});},getAllQuestions:function getAllQuestions(req,res){cov_1v7dyldmrm.f[2]++;var data=(cov_1v7dyldmrm.s[14]++,req.params.meetupId);var allQuestions=(cov_1v7dyldmrm.s[15]++,_questionsModels2.default.getMeetupQuestions(data));var count=(cov_1v7dyldmrm.s[16]++,allQuestions.length);cov_1v7dyldmrm.s[17]++;if(count>0){cov_1v7dyldmrm.b[4][0]++;cov_1v7dyldmrm.s[18]++;return res.status(200).json({data:allQuestions.map(function(question){cov_1v7dyldmrm.f[3]++;cov_1v7dyldmrm.s[19]++;return{createdBy:question.createdBy,meetupId:question.meetupId,title:question.title,body:question.body,upvote:question.upvote,downvote:question.downvote};})});}else{cov_1v7dyldmrm.b[4][1]++;}cov_1v7dyldmrm.s[20]++;return res.status(404).json({message:'No questions for this meetup'});},delete:function _delete(req,res){cov_1v7dyldmrm.f[4]++;//confirm if question exists
var data=(cov_1v7dyldmrm.s[21]++,req.params.questionId);var confirm=(cov_1v7dyldmrm.s[22]++,_questionsModels2.default.forDel(data));cov_1v7dyldmrm.s[23]++;if(confirm){cov_1v7dyldmrm.b[5][0]++;cov_1v7dyldmrm.s[24]++;_questionsModels2.default.delete(data);cov_1v7dyldmrm.s[25]++;return res.status(200).json({message:'Question Deleted'});}else{cov_1v7dyldmrm.b[5][1]++;}cov_1v7dyldmrm.s[26]++;return res.status(404).json({message:'Question not found!'});},upvote:function upvote(req,res){cov_1v7dyldmrm.f[5]++;var data=(cov_1v7dyldmrm.s[27]++,req.params.questionId);var theQuestion=(cov_1v7dyldmrm.s[28]++,_questionsModels2.default.forDel(data.questionId));// does the user exist
var theUser=(cov_1v7dyldmrm.s[29]++,_usersModels2.default.findUser(data.userId));// does the meetup exist
var theMeetup=(cov_1v7dyldmrm.s[30]++,_meetupsModels2.default.getOne(data.meetupId));cov_1v7dyldmrm.s[31]++;if((cov_1v7dyldmrm.b[7][0]++,theQuestion)&&(cov_1v7dyldmrm.b[7][1]++,theUser)&&(cov_1v7dyldmrm.b[7][2]++,theMeetup)){cov_1v7dyldmrm.b[6][0]++;var upvoteQuestion=(cov_1v7dyldmrm.s[32]++,_questionsModels2.default.requestUpvote(req.body));cov_1v7dyldmrm.s[33]++;return res.status(200).json({downvote:upvoteQuestion.downvote,upvote:upvoteQuestion.upvote});}else{cov_1v7dyldmrm.b[6][1]++;}cov_1v7dyldmrm.s[34]++;return res.status(404).json({message:'Question with this ID Not found'});},downvote:function downvote(req,res){cov_1v7dyldmrm.f[6]++;var data=(cov_1v7dyldmrm.s[35]++,req.params.questionId);//does the question exist
var theQuestion=(cov_1v7dyldmrm.s[36]++,_questionsModels2.default.forDel(data.questionId));// does the user exist
var theUser=(cov_1v7dyldmrm.s[37]++,_usersModels2.default.findUser(data.userId));// does the meetup exist
var theMeetup=(cov_1v7dyldmrm.s[38]++,_meetupsModels2.default.getOne(data.meetupId));cov_1v7dyldmrm.s[39]++;if((cov_1v7dyldmrm.b[9][0]++,theQuestion)&&(cov_1v7dyldmrm.b[9][1]++,theUser)&&(cov_1v7dyldmrm.b[9][2]++,theMeetup)){cov_1v7dyldmrm.b[8][0]++;var upvoteQuestion=(cov_1v7dyldmrm.s[40]++,_questionsModels2.default.requestDownvote(req.body));cov_1v7dyldmrm.s[41]++;return res.status(200).json({downvote:upvoteQuestion.downvote,upvote:upvoteQuestion.upvote});}else{cov_1v7dyldmrm.b[8][1]++;}cov_1v7dyldmrm.s[42]++;return res.status(404).json({message:'Question with this ID Not found'});}});cov_1v7dyldmrm.s[43]++;exports.default=Questions;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInF1ZXN0aW9uc0NvbnRyb2xsZXJzLmpzIl0sIm5hbWVzIjpbIlF1ZXN0aW9ucyIsImNyZWF0ZVF1ZXN0aW9uIiwicmVxIiwicmVzIiwiZGF0YSIsImJvZHkiLCJ0aXRsZSIsIm1lZXR1cElkIiwidXNlciIsInF1ZXN0aW9uSWQiLCJ1cHZvdGVzIiwiZG93bnZvdGVzIiwic3RhdHVzIiwianNvbiIsIm1lc3NhZ2UiLCJjcmVhdGVkUXVlc3Rpb24iLCJxdWVzdGlvbnNNb2RlbHMiLCJhc2tRdWVzdGlvbiIsInJlbGVhc2VFdmVudHMiLCJjcmVhdGVkQnkiLCJ1cHZvdGUiLCJkb3dudm90ZSIsIlBvc3QiLCJ0eXBlIiwidXJsIiwidXBWb3RlX1F1ZXN0aW9uIiwiZG93blZvdGVfUXVlc3Rpb24iLCJnZXRBbGxRdWVzdGlvbnMiLCJwYXJhbXMiLCJhbGxRdWVzdGlvbnMiLCJnZXRNZWV0dXBRdWVzdGlvbnMiLCJjb3VudCIsImxlbmd0aCIsIm1hcCIsInF1ZXN0aW9uIiwiZGVsZXRlIiwiY29uZmlybSIsImZvckRlbCIsInRoZVF1ZXN0aW9uIiwidGhlVXNlciIsInVzZXJzTW9kZWxzIiwiZmluZFVzZXIiLCJ1c2VySWQiLCJ0aGVNZWV0dXAiLCJtZWV0dXBzTW9kZWxzIiwiZ2V0T25lIiwidXB2b3RlUXVlc3Rpb24iLCJyZXF1ZXN0VXB2b3RlIiwicmVxdWVzdERvd252b3RlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTs7OztBQUNBOzs7O0FBQ0E7Ozs7OztBQUVBLElBQU1BLFlBQVk7QUFDZEMsa0JBRGMsMEJBQ0NDLEdBREQsRUFDTUMsR0FETixFQUNXO0FBQ3JCLFlBQU1DLE9BQU9GLElBQUlHLElBQWpCO0FBQ0EsWUFBRyxDQUFDRCxLQUFLRSxLQUFOLElBQWUsQ0FBQ0YsS0FBS0MsSUFBckIsSUFDSSxDQUFDRCxLQUFLRyxRQURWLElBQ3NCLENBQUNILEtBQUtJLElBRDVCLElBRUksQ0FBQ0osS0FBS0ssVUFGVixJQUV3QixDQUFDTCxLQUFLTSxPQUY5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ckIsQ0FBUDtBQUlIO0FBQ0QsZUFBT2pCLElBQUlTLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQjtBQUN4QkMscUJBQVM7QUFEZSxTQUFyQixDQUFQO0FBR0g7QUE1R2EsQ0FBbEI7O2tCQStHZWQsUyIsImZpbGUiOiJxdWVzdGlvbnNDb250cm9sbGVycy5qcyIsInNvdXJjZVJvb3QiOiJDOi9Vc2Vycy9IUC9EZXNrdG9wL3RoZUJvb3RjYW1wL3YxL2NvbnRyb2xsZXJzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHF1ZXN0aW9uc01vZGVscyBmcm9tICcuLi9tb2RlbHMvcXVlc3Rpb25zTW9kZWxzJztcclxuaW1wb3J0IG1lZXR1cHNNb2RlbHMgZnJvbSAnLi4vbW9kZWxzL21lZXR1cHNNb2RlbHMnO1xyXG5pbXBvcnQgdXNlcnNNb2RlbHMgZnJvbSAnLi4vbW9kZWxzL3VzZXJzTW9kZWxzJ1xyXG5cclxuY29uc3QgUXVlc3Rpb25zID0ge1xyXG4gICAgY3JlYXRlUXVlc3Rpb24ocmVxLCByZXMpIHtcclxuICAgICAgICBjb25zdCBkYXRhID0gcmVxLmJvZHk7XHJcbiAgICAgICAgaWYoIWRhdGEudGl0bGUgJiYgIWRhdGEuYm9keVxyXG4gICAgICAgICAgICAmJiAhZGF0YS5tZWV0dXBJZCAmJiAhZGF0YS51c2VyXHJcbiAgICAgICAgICAgICYmICFkYXRhLnF1ZXN0aW9uSWQgJiYgIWRhdGEudXB2b3Rlc1xyXG4gICAgICAgICAgICAmJiAhZGF0YS5kb3dudm90ZXMpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ0FsbCBmaWVsZHMgYXJlIHJlcXVpcmVkJ1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgY3JlYXRlZFF1ZXN0aW9uID0gcXVlc3Rpb25zTW9kZWxzLmFza1F1ZXN0aW9uKHJlcS5ib2R5KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlbGVhc2VFdmVudHMuc3RhdHVzKDIwMSkuanNvbih7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQnk6IGNyZWF0ZWRRdWVzdGlvbi5jcmVhdGVkQnksXHJcbiAgICAgICAgICAgICAgICBtZWV0dXBJZDogY3JlYXRlZFF1ZXN0aW9uLm1lZXR1cElkLFxyXG4gICAgICAgICAgICAgICAgcXVlc3Rpb25JZDogY3JlYXRlZFF1ZXN0aW9uLnF1ZXN0aW9uSWQsIFxyXG4gICAgICAgICAgICAgICAgYm9keTogY3JlYXRlZFF1ZXN0aW9uLmJvZHksXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogY3JlYXRlZFF1ZXN0aW9uLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgdXB2b3RlOiBjcmVhdGVkUXVlc3Rpb24udXB2b3RlLFxyXG4gICAgICAgICAgICAgICAgZG93bnZvdGU6IGNyZWF0ZWRRdWVzdGlvbi5kb3dudm90ZSxcclxuICAgICAgICAgICAgICAgIFBvc3Q6IHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnR0VUJyxcclxuICAgICAgICAgICAgICAgICAgICB1cmw6IGBodHRwOi8vbG9jYWxob3N0OjMwMDAvdjEvbWVldHVwcy8ke2NyZWF0ZWRRdWVzdGlvbi5tZWV0dXBJZH1gLFxyXG4gICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICB1cFZvdGVfUXVlc3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnUEFUQ0gnLFxyXG4gICAgICAgICAgICAgICAgICAgIHVybDogYGh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC92MS9xdWVzdGlvbnMvJHtjcmVhdGVkUXVlc3Rpb24ucXVlc3Rpb25JZH0vdXB2b3RlYCxcclxuICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgZG93blZvdGVfUXVlc3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnUEFUQ0gnLFxyXG4gICAgICAgICAgICAgICAgICAgIHVybDogYGh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC92MS9xdWVzdGlvbnMvJHtjcmVhdGVkUXVlc3Rpb24ucXVlc3Rpb25JZH0vZG93bnZvdGVgLFxyXG4gICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB9KTtcclxuICAgIH0sIFxyXG5cclxuICAgIGdldEFsbFF1ZXN0aW9ucyhyZXEsIHJlcykge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSByZXEucGFyYW1zLm1lZXR1cElkO1xyXG4gICAgICAgIGNvbnN0IGFsbFF1ZXN0aW9ucyA9IHF1ZXN0aW9uc01vZGVscy5nZXRNZWV0dXBRdWVzdGlvbnMoZGF0YSk7XHJcbiAgICAgICAgY29uc3QgY291bnQgPSBhbGxRdWVzdGlvbnMubGVuZ3RoO1xyXG4gICAgICAgIGlmKGNvdW50ID4gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xyXG4gICAgICAgICAgICAgICAgZGF0YTogYWxsUXVlc3Rpb25zLm1hcChxdWVzdGlvbiA9PiAoe1xyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRCeTogcXVlc3Rpb24uY3JlYXRlZEJ5LFxyXG4gICAgICAgICAgICAgICAgICAgIG1lZXR1cElkOiBxdWVzdGlvbi5tZWV0dXBJZCwgXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHF1ZXN0aW9uLnRpdGxlLCBcclxuICAgICAgICAgICAgICAgICAgICBib2R5OiBxdWVzdGlvbi5ib2R5LFxyXG4gICAgICAgICAgICAgICAgICAgIHVwdm90ZTogcXVlc3Rpb24udXB2b3RlLFxyXG4gICAgICAgICAgICAgICAgICAgIGRvd252b3RlOiBxdWVzdGlvbi5kb3dudm90ZVxyXG4gICAgICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xyXG4gICAgICAgICAgICBtZXNzYWdlOiAnTm8gcXVlc3Rpb25zIGZvciB0aGlzIG1lZXR1cCdcclxuICAgICAgICB9KVxyXG4gICAgfSxcclxuXHJcbiAgICBkZWxldGUocmVxLCByZXMpIHtcclxuICAgICAgICAvL2NvbmZpcm0gaWYgcXVlc3Rpb24gZXhpc3RzXHJcbiAgICAgICAgY29uc3QgZGF0YSA9IHJlcS5wYXJhbXMucXVlc3Rpb25JZDtcclxuICAgICAgICBjb25zdCBjb25maXJtID0gcXVlc3Rpb25zTW9kZWxzLmZvckRlbChkYXRhKTtcclxuICAgICAgICBpZihjb25maXJtKSB7XHJcbiAgICAgICAgICAgIHF1ZXN0aW9uc01vZGVscy5kZWxldGUoZGF0YSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnUXVlc3Rpb24gRGVsZXRlZCdcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7XHJcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdRdWVzdGlvbiBub3QgZm91bmQhJ1xyXG4gICAgICAgIH0pXHJcbiAgICB9LFxyXG5cclxuICAgIHVwdm90ZShyZXEsIHJlcykge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSByZXEucGFyYW1zLnF1ZXN0aW9uSWQ7XHJcbiAgICAgICAgY29uc3QgdGhlUXVlc3Rpb24gPSBxdWVzdGlvbnNNb2RlbHMuZm9yRGVsKGRhdGEucXVlc3Rpb25JZCk7XHJcbiAgICAgICAgLy8gZG9lcyB0aGUgdXNlciBleGlzdFxyXG4gICAgICAgIGNvbnN0IHRoZVVzZXIgPSB1c2Vyc01vZGVscy5maW5kVXNlcihkYXRhLnVzZXJJZCk7XHJcbiAgICAgICAgLy8gZG9lcyB0aGUgbWVldHVwIGV4aXN0XHJcbiAgICAgICAgY29uc3QgdGhlTWVldHVwID0gbWVldHVwc01vZGVscy5nZXRPbmUoZGF0YS5tZWV0dXBJZCk7XHJcbiAgICAgICAgaWYodGhlUXVlc3Rpb24gJiYgdGhlVXNlciAmJiB0aGVNZWV0dXApe1xyXG4gICAgICAgICAgICBjb25zdCB1cHZvdGVRdWVzdGlvbiA9IHF1ZXN0aW9uc01vZGVscy5yZXF1ZXN0VXB2b3RlKHJlcS5ib2R5KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcclxuICAgICAgICAgICAgICAgIGRvd252b3RlOiB1cHZvdGVRdWVzdGlvbi5kb3dudm90ZSxcclxuICAgICAgICAgICAgICAgIHVwdm90ZTogdXB2b3RlUXVlc3Rpb24udXB2b3RlXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xyXG4gICAgICAgICAgICBtZXNzYWdlOiAnUXVlc3Rpb24gd2l0aCB0aGlzIElEIE5vdCBmb3VuZCdcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgZG93bnZvdGUocmVxLCByZXMpIHtcclxuICAgICAgICBjb25zdCBkYXRhID0gcmVxLnBhcmFtcy5xdWVzdGlvbklkO1xyXG4gICAgICAgIC8vZG9lcyB0aGUgcXVlc3Rpb24gZXhpc3RcclxuICAgICAgICBjb25zdCB0aGVRdWVzdGlvbiA9IHF1ZXN0aW9uc01vZGVscy5mb3JEZWwoZGF0YS5xdWVzdGlvbklkKTtcclxuICAgICAgICAvLyBkb2VzIHRoZSB1c2VyIGV4aXN0XHJcbiAgICAgICAgY29uc3QgdGhlVXNlciA9IHVzZXJzTW9kZWxzLmZpbmRVc2VyKGRhdGEudXNlcklkKTtcclxuICAgICAgICAvLyBkb2VzIHRoZSBtZWV0dXAgZXhpc3RcclxuICAgICAgICBjb25zdCB0aGVNZWV0dXAgPSBtZWV0dXBzTW9kZWxzLmdldE9uZShkYXRhLm1lZXR1cElkKTtcclxuICAgICAgICBpZih0aGVRdWVzdGlvbiAmJiB0aGVVc2VyICYmIHRoZU1lZXR1cCl7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwdm90ZVF1ZXN0aW9uID0gcXVlc3Rpb25zTW9kZWxzLnJlcXVlc3REb3dudm90ZShyZXEuYm9keSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7XHJcbiAgICAgICAgICAgICAgICBkb3dudm90ZTogdXB2b3RlUXVlc3Rpb24uZG93bnZvdGUsXHJcbiAgICAgICAgICAgICAgICB1cHZvdGU6IHVwdm90ZVF1ZXN0aW9uLnVwdm90ZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHtcclxuICAgICAgICAgICAgbWVzc2FnZTogJ1F1ZXN0aW9uIHdpdGggdGhpcyBJRCBOb3QgZm91bmQnXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFF1ZXN0aW9uczsiXX0=